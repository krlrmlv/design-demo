# :building_construction: Пред подготовка к деплою (опционально) :building_construction:

#### :memo: Оглавление: :memo:

1. [Sentry](#sentry)

[//]: # (2. [Структура]&#40;#структура-проекта&#41;)

## Sentry

В проект, опционально, можно интегрировать систему мониторинга производительности приложения и отслеживания
ошибок [Sentry](https://sentry.io).

#### Серверная часть (больше для devops):

- Разворачивание Sentry на выделенном сервере можно выполнять по [инструкции](https://develop.sentry.dev/self-hosted/).

#### Клиентская часть с учётом того, что сервер Sentry на выделенном сервере (devops):

1. Для того чтобы интегрировать sentry в свой проект, необходимо сделать мёрдж ветки sentry в ветку разработки (
   develop/preprod/main).
2. В административной панели получить/сгенерировать токены аутентификации, если их
   нет по адресу `/settings/sentry/auth-tokens/` (devops в помощь).
3. В административной панели должен быть создан проект, у которого свой DSN. Чтобы его получить, нужно перейти в
   настройки проекта, вкладка `Client Keys (DSN)` и получить DSN (примерно выглядит
   так http://ed39c64e97159e786f54b5975dcd9108@127.0.0.1:9000/1) (devops в помощь).
4. В корне проекта создать файл `.sentryclirc` с таким содержимым:
    ```json
    [auth]
    "token"="ТОКЕН_ИЗ_ПУНКТА_2"
    ```
5. В файлах `sentry.*.config.ts` изменить DSN на DSN из пункта 3.
6. В файле `next.config.js` в модуле настроек Sentry - `withSentryConfig` изменить `url` на адрес удалённого сервера, на
   котором развёрнут Sentry.
7. Пример обработки ошибки расположен по адресу [sentry-example-page](../src/app/sentry-example-page/page.tsx). Также
   обработчик Sentry добавлен на [страницу глобальных ошибок](../src/app/global-error.tsx).